{% extends 'base.html' %}
{% block title %}Duyá»‡t Ä‘Ã¡nh giÃ¡{% endblock %}
{% block content %}
<div class="admin-header">
  <h2>HÃ ng chá» duyá»‡t review</h2>
  <p class="muted">Chá»‰ dÃ nh cho admin</p>
  <p><a class="btn secondary" href="{{ url_for('admin_books') }}">â† Quáº£n trá»‹ sÃ¡ch</a></p>
</div>

<!-- Thá»‘ng kÃª review -->
<div class="review-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 24px 0;">
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: #fbbf24; margin-bottom: 8px;">{{ pending|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">Review chá» duyá»‡t</div>
  </div>
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: var(--primary); margin-bottom: 8px;">{{ pending|selectattr('rating', 'equalto', 5)|list|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">ÄÃ¡nh giÃ¡ 5 sao</div>
  </div>
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: var(--accent); margin-bottom: 8px;">{{ pending|selectattr('rating', 'ge', 4)|list|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">ÄÃ¡nh giÃ¡ tÃ­ch cá»±c</div>
  </div>
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: #ef4444; margin-bottom: 8px;">{{ pending|selectattr('rating', 'lt', 3)|list|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">ÄÃ¡nh giÃ¡ tiÃªu cá»±c</div>
  </div>
</div>
<table class="table">
  <thead>
    <tr>
      <th>ID</th><th>SÃ¡ch</th><th>NgÆ°á»i gá»­i</th><th>Äiá»ƒm</th><th>Thá»i gian</th><th></th>
    </tr>
  </thead>
  <tbody>
    {% for r in pending %}
    <tr>
      <td>{{ r.id }}</td>
      <td><a href="{{ url_for('book_detail', book_id=r.book_id) }}" target="_blank">{{ r.book_title }}</a></td>
      <td>{{ r.reviewer }}</td>
      <td>{{ r.rating }}</td>
      <td>{{ r.created_at }}</td>
      <td style="text-align:right;display:flex;gap:8px;justify-content:flex-end">
        <a class="btn secondary" href="{{ url_for('admin_review_edit', review_id=r.id) }}">Sá»­a chi tiáº¿t</a>
        <form method="post" action="{{ url_for('admin_review_approve', review_id=r.id) }}">
          <button class="btn" type="submit">Duyá»‡t</button>
        </form>
        <form method="post" action="{{ url_for('admin_review_reject', review_id=r.id) }}">
          <input name="reason" placeholder="LÃ½ do tá»« chá»‘i" style="background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:8px">
          <button class="btn secondary" type="submit">Tá»« chá»‘i</button>
        </form>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="6"><p class="muted">KhÃ´ng cÃ³ review chá» duyá»‡t.</p></td></tr>
    {% endfor %}
  </tbody>
</table>

<!-- HÆ°á»›ng dáº«n duyá»‡t review -->
<div class="review-guide" style="background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin: 32px 0;">
  <h3 style="color: var(--text); margin: 0 0 16px 0; font-size: 20px;">ğŸ“ HÆ°á»›ng dáº«n duyá»‡t Ä‘Ã¡nh giÃ¡</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
    <div>
      <h4 style="color: var(--primary); margin: 0 0 8px 0;">âœ… TiÃªu chÃ­ duyá»‡t</h4>
      <ul style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.6; padding-left: 20px;">
        <li>Ná»™i dung cÃ³ Ã½ nghÄ©a vÃ  há»¯u Ã­ch</li>
        <li>KhÃ´ng chá»©a spam hoáº·c quáº£ng cÃ¡o</li>
        <li>NgÃ´n ngá»¯ lá»‹ch sá»±, khÃ´ng xÃºc pháº¡m</li>
        <li>LiÃªn quan Ä‘áº¿n ná»™i dung sÃ¡ch</li>
      </ul>
    </div>
    <div>
      <h4 style="color: var(--accent); margin: 0 0 8px 0;">âŒ LÃ½ do tá»« chá»‘i</h4>
      <ul style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.6; padding-left: 20px;">
        <li>Ná»™i dung khÃ´ng phÃ¹ há»£p</li>
        <li>Spam hoáº·c quáº£ng cÃ¡o</li>
        <li>NgÃ´n ngá»¯ thÃ´ tá»¥c</li>
        <li>KhÃ´ng liÃªn quan Ä‘áº¿n sÃ¡ch</li>
      </ul>
    </div>
    <div>
      <h4 style="color: #fbbf24; margin: 0 0 8px 0;">â­ ÄÃ¡nh giÃ¡ cháº¥t lÆ°á»£ng</h4>
      <ul style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.6; padding-left: 20px;">
        <li>5 sao: Xuáº¥t sáº¯c, Ä‘Ã¡ng Ä‘á»c</li>
        <li>4 sao: Tá»‘t, cÃ³ giÃ¡ trá»‹</li>
        <li>3 sao: BÃ¬nh thÆ°á»ng</li>
        <li>2 sao: KÃ©m, khÃ´ng nÃªn Ä‘á»c</li>
        <li>1 sao: Ráº¥t kÃ©m</li>
      </ul>
    </div>
    <div>
      <h4 style="color: #ef4444; margin: 0 0 8px 0;">âš ï¸ LÆ°u Ã½ quan trá»ng</h4>
      <p style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.5;">
        LuÃ´n Ä‘á»c ká»¹ ná»™i dung review trÆ°á»›c khi duyá»‡t. Tá»« chá»‘i review cáº§n cÃ³ lÃ½ do rÃµ rÃ ng Ä‘á»ƒ ngÆ°á»i dÃ¹ng hiá»ƒu.
      </p>
    </div>
  </div>
</div>

<!-- Thá»‘ng kÃª Ä‘Ã¡nh giÃ¡ theo thá»i gian -->
<div class="review-timeline" style="background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin: 32px 0;">
  <h3 style="color: var(--text); margin: 0 0 16px 0; font-size: 20px;">ğŸ“Š Thá»‘ng kÃª Ä‘Ã¡nh giÃ¡</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
    <div style="text-align: center; padding: 16px; background: color-mix(in oklab, var(--primary) 10%, transparent); border-radius: 12px;">
      <div style="font-size: 24px; font-weight: 700; color: var(--primary);">â­</div>
      <div style="color: var(--muted); font-size: 12px; margin-top: 4px;">ÄÃ¡nh giÃ¡ cao</div>
    </div>
    <div style="text-align: center; padding: 16px; background: color-mix(in oklab, var(--accent) 10%, transparent); border-radius: 12px;">
      <div style="font-size: 24px; font-weight: 700; color: var(--accent);">ğŸ“</div>
      <div style="color: var(--muted); font-size: 12px; margin-top: 4px;">Review chi tiáº¿t</div>
    </div>
    <div style="text-align: center; padding: 16px; background: color-mix(in oklab, #fbbf24 10%, transparent); border-radius: 12px;">
      <div style="font-size: 24px; font-weight: 700; color: #fbbf24;">â°</div>
      <div style="color: var(--muted); font-size: 12px; margin-top: 4px;">Gáº§n Ä‘Ã¢y</div>
    </div>
    <div style="text-align: center; padding: 16px; background: color-mix(in oklab, #ef4444 10%, transparent); border-radius: 12px;">
      <div style="font-size: 24px; font-weight: 700; color: #ef4444;">ğŸš«</div>
      <div style="color: var(--muted); font-size: 12px; margin-top: 4px;">Cáº§n xem xÃ©t</div>
    </div>
  </div>
</div>

<!-- LiÃªn káº¿t nhanh -->
<div class="quick-links" style="background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin: 32px 0;">
  <h3 style="color: var(--text); margin: 0 0 20px 0; font-size: 20px; font-weight: 700;">ğŸ”— LiÃªn káº¿t nhanh</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: var(--primary); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ“š Quáº£n trá»‹ sÃ¡ch</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Quáº£n lÃ½ vÃ  chá»‰nh sá»­a thÃ´ng tin sÃ¡ch</p>
      <a href="{{ url_for('admin_books') }}" class="btn" style="background: var(--primary); color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: var(--accent); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ“– Xem táº¥t cáº£ sÃ¡ch</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Duyá»‡t qua toÃ n bá»™ thÆ° viá»‡n sÃ¡ch</p>
      <a href="{{ url_for('books_list') }}" class="btn" style="background: var(--accent); color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: #10b981; margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ  Trang chá»§</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Quay vá» trang chá»§ cá»§a há»‡ thá»‘ng</p>
      <a href="{{ url_for('home') }}" class="btn" style="background: #10b981; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: #8b5cf6; margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ‘¤ Há»“ sÆ¡ cÃ¡ nhÃ¢n</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Xem vÃ  chá»‰nh sá»­a thÃ´ng tin cÃ¡ nhÃ¢n</p>
      <a href="{{ url_for('profile') }}" class="btn" style="background: #8b5cf6; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
  </div>
</div>
{% endblock %}


