{% extends 'base.html' %}
{% block title %}Quáº£n trá»‹ sÃ¡ch{% endblock %}
{% block content %}
<div class="admin-header">
  <h2>Quáº£n trá»‹ sÃ¡ch</h2>
  <p class="muted">Chá»‰ dÃ nh cho admin</p>
    <a class="btn" href="{{ url_for('admin_books_new') }}">+ ThÃªm sÃ¡ch</a>
    <form method="post" action="{{ url_for('admin_seed_demo') }}" onsubmit="return confirm('ThÃªm sÃ¡ch demo?')" style="display:inline-block;margin-left:8px">
      <button class="btn secondary" type="submit">Seed sÃ¡ch demo</button>
    </form>
    <form method="post" action="{{ url_for('admin_fix_book_codes') }}" onsubmit="return confirm('Tá»± sinh mÃ£ sÃ¡ch máº¥t?')" style="display:inline-block;margin-left:8px">
      <button class="btn secondary" type="submit">Tá»± sinh mÃ£ sÃ¡ch máº¥t</button>
    </form>
  <form method="post" action="{{ url_for('admin_generate_long_reviews') }}" onsubmit="return confirm('Táº¡o review máº«u dÃ i cho cÃ¡c sÃ¡ch chÆ°a cÃ³ review?')" style="display:inline-block;margin-left:8px">
    <button class="btn secondary" type="submit">Táº¡o review máº«u dÃ i</button>
  </form>
  <form method="post" action="{{ url_for('admin_generate_long_summaries') }}" onsubmit="return confirm('Táº¡o/cáº­p nháº­t tÃ³m táº¯t dÃ i cho cÃ¡c sÃ¡ch mÃ´ táº£ ngáº¯n?')" style="display:inline-block;margin-left:8px">
    <button class="btn secondary" type="submit">Táº¡o tÃ³m táº¯t dÃ i</button>
  </form>
</div>

<!-- Thá»‘ng kÃª tá»•ng quan -->
<div class="admin-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 24px 0;">
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: var(--primary); margin-bottom: 8px;">{{ books|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">Tá»•ng sá»‘ sÃ¡ch</div>
  </div>
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: var(--accent); margin-bottom: 8px;">{{ books|selectattr('genre')|list|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">SÃ¡ch cÃ³ thá»ƒ loáº¡i</div>
  </div>
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: #fbbf24; margin-bottom: 8px;">{{ books|selectattr('book_code')|list|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">SÃ¡ch cÃ³ mÃ£</div>
  </div>
  <div class="stat-card" style="background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center;">
    <div style="font-size: 32px; font-weight: 800; color: #ef4444; margin-bottom: 8px;">{{ books|rejectattr('book_code')|list|length }}</div>
    <div style="color: var(--muted); font-size: 14px;">SÃ¡ch thiáº¿u mÃ£</div>
  </div>
</div>

<div style="margin:8px 0;display:flex;gap:8px;align-items:center">
  <span class="muted">Sáº¯p xáº¿p:</span>
  <a class="btn secondary" href="{{ url_for('admin_books', sort='title_asc') }}">A â†’ Z (TiÃªu Ä‘á»)</a>
  <a class="btn secondary" href="{{ url_for('admin_books', sort='title_desc') }}">Z â†’ A (TiÃªu Ä‘á»)</a>
  <a class="btn secondary" href="{{ url_for('admin_books', sort='id_asc') }}">ID â†‘</a>
  <a class="btn secondary" href="{{ url_for('admin_books', sort='id_desc') }}">ID â†“</a>
</div>
<table class="table">
  <thead>
    <tr>
      <th>ID</th><th>MÃ£</th><th>TiÃªu Ä‘á»</th><th>TÃ¡c giáº£</th><th>HÃ nh Ä‘á»™ng</th>
    </tr>
  </thead>
  <tbody>
    {% for b in books %}
    <tr>
      <td>{{ b.id }}</td>
      <td>{{ b.book_code or '-' }}</td>
      <td>{{ b.title }}</td>
      <td>{{ b.author }}</td>
      <td>
        <a href="{{ url_for('admin_books_edit', book_id=b.id) }}" style="background: #10b981; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600; margin-right: 8px; display: inline-block; width: 70px; text-align: center; box-sizing: border-box;">Sá»­a</a>
        <form method="post" action="{{ url_for('admin_books_delete', book_id=b.id) }}" onsubmit="return confirm('XoÃ¡ sÃ¡ch nÃ y?')" style="display:inline-block;">
          <button type="submit" style="background: #ef4444; color: white; padding: 8px 16px; border-radius: 6px; border: none; font-weight: 600; cursor: pointer; width: 70px; text-align: center; box-sizing: border-box;">XoÃ¡</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- HÆ°á»›ng dáº«n quáº£n trá»‹ -->
<div class="admin-guide" style="background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin: 32px 0;">
  <h3 style="color: var(--text); margin: 0 0 16px 0; font-size: 20px;">ğŸ“š HÆ°á»›ng dáº«n quáº£n trá»‹ sÃ¡ch</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
    <div>
      <h4 style="color: var(--primary); margin: 0 0 8px 0;">â• ThÃªm sÃ¡ch má»›i</h4>
      <p style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.5;">
        Sá»­ dá»¥ng nÃºt "ThÃªm sÃ¡ch" Ä‘á»ƒ thÃªm sÃ¡ch má»›i vÃ o há»‡ thá»‘ng. Äáº£m báº£o Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin tiÃªu Ä‘á», tÃ¡c giáº£, thá»ƒ loáº¡i vÃ  mÃ´ táº£.
      </p>
    </div>
    <div>
      <h4 style="color: var(--accent); margin: 0 0 8px 0;">ğŸ·ï¸ Quáº£n lÃ½ mÃ£ sÃ¡ch</h4>
      <p style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.5;">
        Má»—i sÃ¡ch cáº§n cÃ³ mÃ£ Ä‘á»‹nh danh duy nháº¥t. Sá»­ dá»¥ng "Tá»± sinh mÃ£ sÃ¡ch máº¥t" Ä‘á»ƒ táº¡o mÃ£ cho cÃ¡c sÃ¡ch chÆ°a cÃ³.
      </p>
    </div>
    <div>
      <h4 style="color: #fbbf24; margin: 0 0 8px 0;">ğŸ“Š Thá»‘ng kÃª</h4>
      <p style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.5;">
        Theo dÃµi sá»‘ lÆ°á»£ng sÃ¡ch, thá»ƒ loáº¡i vÃ  tÃ¬nh tráº¡ng mÃ£ sÃ¡ch Ä‘á»ƒ Ä‘áº£m báº£o há»‡ thá»‘ng hoáº¡t Ä‘á»™ng tá»‘t.
      </p>
    </div>
    <div>
      <h4 style="color: #ef4444; margin: 0 0 8px 0;">âš ï¸ LÆ°u Ã½ quan trá»ng</h4>
      <p style="color: var(--muted); margin: 0; font-size: 14px; line-height: 1.5;">
        LuÃ´n kiá»ƒm tra thÃ´ng tin sÃ¡ch trÆ°á»›c khi thÃªm. XÃ³a sÃ¡ch sáº½ khÃ´ng thá»ƒ hoÃ n tÃ¡c.
      </p>
    </div>
  </div>
</div>

<!-- Thá»ƒ loáº¡i phá»• biáº¿n -->
<div class="popular-genres" style="background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin: 32px 0;">
  <h3 style="color: var(--text); margin: 0 0 16px 0; font-size: 20px;">ğŸ“– Thá»ƒ loáº¡i sÃ¡ch phá»• biáº¿n</h3>
  <div style="display: flex; flex-wrap: wrap; gap: 12px;">
    <span style="background: var(--primary); color: #06210e; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">Tiá»ƒu thuyáº¿t</span>
    <span style="background: var(--accent); color: #05202a; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">Kinh táº¿</span>
    <span style="background: #fbbf24; color: #451a03; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">Khoa há»c</span>
    <span style="background: #8b5cf6; color: #ffffff; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">TÃ¢m lÃ½</span>
    <span style="background: #06b6d4; color: #ffffff; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">VÄƒn há»c</span>
    <span style="background: #10b981; color: #ffffff; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">Thiáº¿u nhi</span>
    <span style="background: #f59e0b; color: #ffffff; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">Lá»‹ch sá»­</span>
    <span style="background: #ef4444; color: #ffffff; padding: 6px 12px; border-radius: 20px; font-size: 14px; font-weight: 500;">Truyá»‡n ngáº¯n</span>
  </div>
</div>

<!-- LiÃªn káº¿t nhanh -->
<div class="quick-links" style="background: var(--panel); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin: 32px 0;">
  <h3 style="color: var(--text); margin: 0 0 20px 0; font-size: 20px; font-weight: 700;">ğŸ”— LiÃªn káº¿t nhanh</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: var(--primary); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ“ Duyá»‡t Ä‘Ã¡nh giÃ¡</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Kiá»ƒm tra vÃ  phÃª duyá»‡t Ä‘Ã¡nh giÃ¡ tá»« ngÆ°á»i dÃ¹ng</p>
      <a href="{{ url_for('admin_reviews_queue') }}" class="btn" style="background: var(--primary); color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: var(--accent); margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ“š Xem táº¥t cáº£ sÃ¡ch</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Duyá»‡t qua toÃ n bá»™ thÆ° viá»‡n sÃ¡ch</p>
      <a href="{{ url_for('books_list') }}" class="btn" style="background: var(--accent); color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: #10b981; margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ  Trang chá»§</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Quay vá» trang chá»§ cá»§a há»‡ thá»‘ng</p>
      <a href="{{ url_for('home') }}" class="btn" style="background: #10b981; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
    <div style="background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center;">
      <h4 style="color: #8b5cf6; margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">ğŸ‘¤ Há»“ sÆ¡ cÃ¡ nhÃ¢n</h4>
      <p style="color: var(--muted); margin: 0 0 12px 0; font-size: 14px;">Xem vÃ  chá»‰nh sá»­a thÃ´ng tin cÃ¡ nhÃ¢n</p>
      <a href="{{ url_for('profile') }}" class="btn" style="background: #8b5cf6; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-weight: 600;">Truy cáº­p</a>
    </div>
  </div>
</div>
{% endblock %}

